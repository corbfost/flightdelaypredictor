# Flight Delay Predictor
### A new approach to predicting flight delays using machine learning.
#### Data Source:
Bureau of Transportation Statistics On-Time Performance Data
#### Model:
Gradient-boosted classifier -> Generalized Linear Models

**Theoretical considerations:**
<br>
At a basic level, flight delays are not normally distributed; early departures are limited by natural constraints, whereas late departures are boundless. In my dataset, actual departures ranged from 54 minutes early to 1,964 minutes late (yikes!), with a median value of 2 minutes early. If we consider early departures to be negative delays, you can visualize the distribution.

![Graph](/modeling/all_delays.png)

In the graph above, we can see that flights almost never leave more than 15 minutes early, but leave 15 minutes late fairly often (roughly 15% of the time, to be exact). If the data were normally distributed, we'd expect the distribution to look the same on both sides of the median. But it does not. This breaks assumptions inherent in fitting a cookie-cutter OLS regression to the data.

Clearly a custom-made, creative solution is necessary to make headway with this problem. From a statistical standpoint, if you were to split the data at -3, you can visualize the data as falling into two exponential distributions: one extending from -3 to infinity, and one extending from -3 to negative infinity.

So I decided to train a classifier (specifically a gradient-boosted tree) to split the data at -3, then used two generalized linear models (GLM) with exponential error distributions to model each side of the split separately. The final result is a custom probability distribution for each flight, generated by bootstrapping 50,000 samples. Grabbing the cumulative probability of values in this distribution allows you to predict the likelihood of a range of outcomes. You can also grab the mean of the distribution to get a measure of central tendency. Both of these are implemented in the production version of the model.

**Evaluation:**
<br>
The final version performed in line with industry expectations for predicting flight delays - recall in the high 60s (exactly where depends on your threshold), high accuracy, and low (15-20%) precision. In other words, the majority of predictions will be false positives, but the model compensate by allowing you to correctly predict 2/3 of delays.

It is inherently incredibly difficult to forecast delays because of the unmeasurable efforts that are actively made to prevent them from happening. However, the hope is that my model better shows the relative tendency of a particular route compared to others, regardless of whether it accurately pinpoints the exact delay.

In a future version of the site, I hope to allow users to see the probability distribution for each flight, as the variability/spread can be often be more important than the mean. Showing the probability of a delay greater than 15 minutes hints at that distribution, but only implicitly.

**Toolkit:**
<br>
I used python (scikit-learn, pandas, numpy, statsmodels) extensively to wrangle the data into shape and train the models. I deployed the web app using Flask, AWS, and of course some HTML/CSS/Bootstrap/Javscript.
